Fix issue #8415, implement multi-arch build and Windows build